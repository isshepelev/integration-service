<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integration Service - API Portal</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <div class="container">
        <header>
            <h1>Integration Service</h1>
            <p class="subtitle">Мультипротокольный API Портал</p>
        </header>

        <main>
            <section class="api-section">
                <h2>Документация API</h2>
                <p>Выберите протокол для просмотра документации или взаимодействия с API:</p>

                <div class="cards">
                    <!-- REST / OpenAPI -->
                    <div class="card rest">
                        <div class="card-icon">REST</div>
                        <h3>REST API</h3>
                        <p>Спецификация OpenAPI 3.0 с Swagger UI для интерактивного исследования.</p>
                        <div class="card-links">
                            <a th:href="@{/swagger-ui.html}" class="btn btn-primary">Swagger UI</a>
                            <a th:href="@{/v3/api-docs}" class="btn btn-secondary" target="_blank">OpenAPI JSON</a>
                            <a th:href="@{/v3/api-docs.yaml}" class="btn btn-secondary" target="_blank">OpenAPI YAML</a>
                        </div>
                        <div class="endpoint-info">
                            <code>GET /api/products</code>
                        </div>
                    </div>

                    <!-- GraphQL -->
                    <div class="card graphql">
                        <div class="card-icon">GraphQL</div>
                        <h3>GraphQL API</h3>
                        <p>Гибкий язык запросов со встроенным GraphiQL IDE для тестирования.</p>
                        <div class="card-links">
                            <a th:href="@{/graphql-playground}" class="btn btn-primary">Playground</a>
                            <a th:href="@{/graphql-examples}" class="btn btn-secondary">Примеры</a>
                            <a th:href="@{/graphiql}" class="btn btn-secondary">GraphiQL IDE</a>
                        </div>
                        <div class="endpoint-info">
                            <code>POST /graphql</code>
                        </div>
                    </div>

                    <!-- gRPC -->
                    <div class="card grpc">
                        <div class="card-icon">gRPC</div>
                        <h3>gRPC API</h3>
                        <p>Высокопроизводительный RPC фреймворк с Protocol Buffers.</p>
                        <div class="card-links">
                            <a href="#grpc-info" class="btn btn-primary" onclick="toggleGrpcInfo()">Информация о подключении</a>
                            <a th:href="@{/grpc-examples}" class="btn btn-secondary">Примеры</a>
                        </div>
                        <div class="endpoint-info">
                            <code th:text="'localhost:' + ${grpcPort}">localhost:9090</code>
                        </div>
                        <div id="grpc-info" class="grpc-details" style="display: none;">
                            <h4>Использование grpcurl:</h4>
                            <pre>
# Список сервисов
grpcurl -plaintext localhost:<span th:text="${grpcPort}">9090</span> list

# Получить продукты
grpcurl -plaintext -d '{}' \
  localhost:<span th:text="${grpcPort}">9090</span> \
  product.ProductService/GetProducts</pre>
                        </div>
                    </div>

                    <!-- SOAP -->
                    <div class="card soap">
                        <div class="card-icon">SOAP</div>
                        <h3>SOAP Web Service</h3>
                        <p>XML-протокол для корпоративной интеграции.</p>
                        <div class="card-links">
                            <a th:href="@{/ws/integration.wsdl}" class="btn btn-primary" target="_blank">WSDL</a>
                            <a th:href="@{/soap-examples}" class="btn btn-secondary">Примеры</a>
                        </div>
                        <div class="endpoint-info">
                            <code>POST /ws</code>
                        </div>
                    </div>
                </div>
            </section>

            <section class="quick-links">
                <h2>Быстрые ссылки</h2>
                <div class="links-grid">
                    <div class="link-group">
                        <h4>API Эндпоинты</h4>
                        <ul>
                            <li><a th:href="@{/api/products}">GET /api/products</a></li>
                            <li><a th:href="@{/api/products?includeAvailability=true}">GET /api/products?includeAvailability=true</a></li>
                            <li><a th:href="@{/api/products/1}">GET /api/products/1</a></li>
                            <li><a th:href="@{/api/products/sku/SAM-S24-BLK}">GET /api/products/sku/SAM-S24-BLK</a></li>
                        </ul>
                    </div>
                    <div class="link-group">
                        <h4>Документация</h4>
                        <ul>
                            <li><a th:href="@{/swagger-ui.html}">Swagger UI</a></li>
                            <li><a th:href="@{/v3/api-docs}">OpenAPI Spec (JSON)</a></li>
                            <li><a th:href="@{/v3/api-docs.yaml}">OpenAPI Spec (YAML)</a></li>
                            <li><a th:href="@{/graphql-playground}">GraphQL Playground</a></li>
                            <li><a th:href="@{/graphql-examples}">GraphQL Examples</a></li>
                            <li><a th:href="@{/graphiql}">GraphiQL IDE</a></li>
                            <li><a th:href="@{/grpc-examples}">gRPC Examples</a></li>
                            <li><a th:href="@{/soap-examples}">SOAP Examples</a></li>
                            <li><a th:href="@{/ws/integration.wsdl}">WSDL Schema</a></li>
                        </ul>
                    </div>
                    <div class="link-group">
                        <h4>Информация о сервере</h4>
                        <ul>
                            <li>HTTP Порт: <code th:text="${serverPort}">8080</code></li>
                            <li>gRPC Порт: <code th:text="${grpcPort}">9090</code></li>
                        </ul>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>Integration Service v1.0.0 | Spring Boot 4.0.1</p>
        </footer>
    </div>

    <script>
        function toggleGrpcInfo() {
            var info = document.getElementById('grpc-info');
            if (info.style.display === 'none') {
                info.style.display = 'block';
            } else {
                info.style.display = 'none';
            }
        }
    </script>
</body>
</html>
